#!/bin/bash
export PATH=$PATH:'/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin'
cd `dirname $0`

check_all(){
    schedule_ret=0
    i=0
    while [ $i -lt 3 ]
    do
        i=$(($i+1))
        schedule_ret=`ps -ef | grep './scheduler' | grep -v grep > /dev/null 2>&1 && echo $?`
        if [ -z $schedule_ret ];then
            sleep 1
            continue
        fi
        break;
    done

    datetime=`date +'%Y%m%d %H:%M:%S'`

    if [ -z $schedule_ret ] ;then
        cd /usr/local/scheduler/bin && ./restart_scheduler.sh
        exit 0
    fi
}
check_all
